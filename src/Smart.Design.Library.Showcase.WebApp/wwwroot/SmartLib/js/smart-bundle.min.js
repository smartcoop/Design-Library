class Toc{constructor(n){this.el=n;this.toc__nav__list=this.el.querySelector(".c-table-of-content__nav");this.toc__nav__list__items=this.el.querySelectorAll("a.c-table-of-content__nav__item");this.toc__content__list=document.querySelector(".c-table-of-content__content");this.toc__content__list__items=document.querySelectorAll(".c-table-of-content__content__item");this.current__index=0;this.current_state=this.el.querySelector(".current-state");this.relativeWidth=this.toc__nav__list.classList.contains("relativeWidth")?!0:!1;this.toc__back_to_top_btn=this.el.querySelector(".back-to-top");this.toc__back_to_top_btn__link=this.toc__back_to_top_btn.querySelector("button");this.toc__back_to_top_btn__visible=!1;this.el_init_top=this.el.offsetTop;this.header_height=document.querySelector("header").offsetHeight;this.main_title_height=document.querySelector(".main-title").offsetHeight;this.elPaddingTop=parseFloat(window.getComputedStyle(this.el,null).getPropertyValue("padding-top"));this.toc__content__list__items__posTop_from_parent=[];this.lastScrollTop=0;this.lastScrollTopd=0;this.currentUrl=window.location.href.split("#")[0];this.whatever=this.callBackScrollEvent.bind(this,n);this.whateverHash=this.callBackHashEvent.bind(this,n);this.init()}init(){this.current_nav_item=this.toc__nav__list.querySelector("[aria-selected]");this.toc__back_to_top_btn.style.display="none";let n=[...this.toc__nav__list__items].indexOf(this.current_nav_item);this.toc__nav__list__items.forEach((t,i)=>{t.setAttribute("data-id",this.convertToSlug(t.textContent)),this.toc__content__list__items[i].setAttribute("data-id",this.convertToSlug(t.textContent)),this.toc__content__list__items.length&&this.attachClickEvents(t,i),i===this.toc__nav__list__items.length-1&&this.callbackItemsSet(n,this.current_nav_item)});this.toc__back_to_top_btn__link.addEventListener("click",n=>{n.preventDefault(),this.scrollTo(this.toc__nav__list)});window.addEventListener("hashchange",this.whateverHash)}attachClickEvents(n){n.addEventListener("click",n=>{n.preventDefault();n.currentTarget.classList.add("clicked");window.removeEventListener("scroll",this.whatever);window.removeEventListener("hashchange",this.whateverHash);let t=this.toc__nav__list.querySelector("[aria-selected]");this.switchTocAfterClick(t,n.currentTarget)})}attachScrollEvents(){window.addEventListener("scroll",this.whatever)}callBackScrollEvent(){var r,t,i;let n=this.el.getBoundingClientRect().top-this.el_init_top-274,f=window.scrollY;r=window.pageYOffset||document.documentElement.scrollTop;-this.el.getBoundingClientRect().top>this.toc__nav__list.clientHeight?this.toc__back_to_top_btn__visible===!1&&(this.fadeIn(this.toc__back_to_top_btn),this.toc__back_to_top_btn__visible=!0):this.toc__back_to_top_btn__visible===!0&&(this.fadeOut(this.toc__back_to_top_btn),this.toc__back_to_top_btn__visible=!1);t=window.pageYOffset||document.documentElement.scrollTop;let u=1;u=t>this.lastScrollTop?-1:1;this.lastScrollTop=t<=0?0:t;this.toc__content__list_length=this.toc__content__list__items__posTop_from_parent.length;for(let t=0;t<this.toc__content__list_length;t++)-n>this.toc__content__list__items__posTop_from_parent[t]&&-n<this.toc__content__list__items__posTop_from_parent[t+1]&&(-n>this.toc__content__list__items__posTop_from_parent[this.toc__content__list_length-3]+this.toc__content__list__items[this.toc__content__list_length-3].offsetHeight/2&&-n<this.toc__content__list__items__posTop_from_parent[this.toc__content__list_length-2]?(console.log("switch"),console.log(this.toc__nav__list__items[t+1]),console.log(this.toc__content__list__items[t+1]),window.removeEventListener("hashchange",this.whateverHash),this.resetActiveToc(this.toc__nav__list__items[t+1],this.toc__content__list__items[t+1],!0),i=this,setTimeout(function(){window.addEventListener("hashchange",i.whateverHash)},750)):this.current__index!=this.toc__nav__list__items[t]&&(window.removeEventListener("hashchange",this.whateverHash),this.resetActiveToc(this.toc__nav__list__items[t],this.toc__content__list__items[t],!0),i=this,setTimeout(function(){window.addEventListener("hashchange",i.whateverHash)},750)))}callBackHashEvent(){let n=window.top.location.hash.substr(1);if(n.length){window.removeEventListener("scroll",this.whatever);let i=this.toc__content__list.querySelector('[data-id="'+n+'"]');this.resetActiveToc(this.toc__nav__list.querySelector('[data-id="'+n+'"]'),i,!0);this.scrollTo(i);var t=this;setTimeout(function(){window.addEventListener("scroll",t.whatever)},750)}}callbackItemsSet(n,t){this.toc__nav__list__items.forEach((n,t)=>{this.toc__content__list__items__posTop_from_parent.push(Math.round(this.toc__content__list__items[t].offsetTop))});this.toc__content__list__items__posTop_from_parent.push(Math.round(this.toc__content__list__items[this.toc__content__list__items.length-1].offsetTop+this.toc__content__list__items[this.toc__content__list__items.length-1].offsetHeight));let i=window.top.location.hash.substr(1);if(i.length){let n=this.toc__content__list.querySelector('[data-id="'+i+'"]'),t=[...this.toc__content__list__items].indexOf(n);this.resetActiveToc(this.toc__nav__list.querySelector('[data-id="'+i+'"]'),n,!0);this.scrollTo(this.toc__content__list__items[t])}else this.resetActiveToc(t,this.toc__content__list__items[n],!1);var r=this;setTimeout(function(){r.attachScrollEvents()},750)}resetActiveToc(n,t,i){this.positionTopCurrentState(n);i&&(window.location.hash=this.convertToSlug(n.textContent));for(let n=0;n<this.toc__nav__list__items.length;n++)this.toc__nav__list__items[n].removeAttribute("aria-selected");for(let n=0;n<this.toc__content__list__items.length;n++)this.toc__content__list__items[n].classList.remove("active");n&&n.setAttribute("aria-selected","true");t&&t.classList.add("active");this.current__index=n}switchTocAfterClick(n,t){t.focus();let i=[...this.toc__nav__list__items].indexOf(t);this.resetActiveToc(t,this.toc__content__list__items[i],!0);this.scrollTo(this.toc__content__list__items[i]);var r=this;setTimeout(function(){t.classList.remove("clicked")},400);setTimeout(function(){window.addEventListener("scroll",r.whatever);window.addEventListener("hashchange",r.whateverHash)},750)}positionTopCurrentState(n){let t=this.toc__nav__list.getBoundingClientRect().top;if(n){let i=n.clientHeight,r=n.getBoundingClientRect().top-t;if(this.current_state.style.top=r+"px",this.current_state.style.height=i+"px",this.relativeWidth){let t=n.offsetWidth;this.current_state.style.width=t+"px"}}}scrollTo(n){let t=this.el.getBoundingClientRect().top+window.scrollY-this.header_height-this.main_title_height,i=[...this.toc__content__list__items].indexOf(n),r=i===0?176+this.elPaddingTop:150+this.elPaddingTop,u=n.offsetTop+(t-r);window.scrollTo({top:u,behavior:"smooth"})}convertToSlug(n){var i,r,t,u;for(n=n.replace(/^\s+|\s+$/g,""),n=n.toLowerCase(),i="àáäâèéëêìíïîòóöôùúüûñç·/_,:;",r="aaaaeeeeiiiioooouuuunc------",t=0,u=i.length;t<u;t++)n=n.replace(new RegExp(i.charAt(t),"g"),r.charAt(t));return n.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-")}fadeOut(n){n.style.opacity=1,function t(){(n.style.opacity-=.1)<0?n.style.display="none":requestAnimationFrame(t)}()}fadeIn(n,t){n.style.opacity=0;n.style.display=t||"block",function i(){var t=parseFloat(n.style.opacity);(t+=.1)>1||(n.style.opacity=t,requestAnimationFrame(i))}()}}const toclists=document.querySelectorAll(".c-table-of-content");toclists.length&&[...toclists].map(n=>new Toc(n));